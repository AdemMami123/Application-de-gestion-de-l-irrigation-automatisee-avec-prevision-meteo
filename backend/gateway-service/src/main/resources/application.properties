# Application Configuration
spring.application.name=gateway-service
server.port=8080

# Eureka Client Configuration
eureka.client.service-url.defaultZone=http://localhost:8761/eureka/
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true
eureka.instance.prefer-ip-address=true
eureka.instance.instance-id=${spring.application.name}:${server.port}

# Redis Configuration for Rate Limiting
spring.data.redis.host=localhost
spring.data.redis.port=6379
spring.data.redis.timeout=2000ms

# Gateway Routes Configuration
# Routes will be configured in Java configuration class for better control

# Circuit Breaker Configuration
resilience4j.circuitbreaker.configs.default.sliding-window-size=10
resilience4j.circuitbreaker.configs.default.permitted-number-of-calls-in-half-open-state=5
resilience4j.circuitbreaker.configs.default.failure-rate-threshold=50
resilience4j.circuitbreaker.configs.default.wait-duration-in-open-state=10s
resilience4j.circuitbreaker.configs.default.register-health-indicator=true

# TimeLimiter Configuration
resilience4j.timelimiter.configs.default.timeout-duration=5s

# Actuator Configuration
management.endpoints.web.exposure.include=health,info,metrics,prometheus,gateway
management.endpoint.health.show-details=always
management.endpoint.gateway.enabled=true
management.metrics.export.prometheus.enabled=true
management.endpoint.metrics.enabled=true

# Distributed Tracing Configuration (Zipkin)
spring.zipkin.base-url=http://localhost:9411
spring.zipkin.enabled=true
spring.sleuth.sampler.probability=1.0
spring.sleuth.log.slf4j.enabled=true

# Logging Configuration
logging.level.root=INFO
logging.level.com.irrigation.gateway=DEBUG
logging.level.org.springframework.cloud.gateway=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# Gateway Global Configuration
# Using allowedOriginPatterns instead of allowedOrigins to support allowCredentials=true
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedOriginPatterns=*
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedMethods=GET,POST,PUT,DELETE,OPTIONS,PATCH
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedHeaders=*
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowCredentials=true

# Discovery Locator (Enable dynamic routing based on service names)
spring.cloud.gateway.discovery.locator.enabled=true
spring.cloud.gateway.discovery.locator.lower-case-service-id=true

# JWT Configuration
jwt.secret=IrrigationSecretKey2024!@#$%^&*()VeryLongSecretKeyForJWT
